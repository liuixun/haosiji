!function(e){function t(a){if(i[a])return i[a].exports;var s=i[a]={exports:{},id:a,loaded:!1};return e[a].call(s.exports,s,s.exports,t),s.loaded=!0,s.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([function(e,t){"use strict";!function(e,t){function i(e){return e*w}function a(e){this.init=function(){this.config=e,s=x.add.group(),s.enableBody=!0,s.createMultiple(e.selfPool,e.selfPic),s.setAll("anchor.y",1),s.setAll("outOfBoundsKill",!0),s.setAll("checkWorldBounds",!0),this.maxWidth=x.width-100,g=x.add.audio("sound"),x.time.events.loop(Phaser.Timer.SECOND*e.rate,this.createQL,this)},this.createQL=function(){var t=s.getFirstExists(!1);if(t){if(c>=e.max)return;c++,t.events.onInputDown.removeAll();var a=Math.random();a=a<.5?a+=.5:a,t.loadTexture(this.config.selfPic),t.alpha=1,t.scale.setTo(i(a)),t.reset(x.rnd.integerInRange(0,this.maxWidth),0),t.body.velocity.y=x.rnd.integerInRange(e.minSpeed,e.maxSpeed),t.config=e,t.inputEnabled=!0,t.events.onInputDown.add(this.hitted,this)}},this.hitted=function(e){switch(r+=e.config.point,g.play(),e.config.num){case 1:l++;break;case 2:d++;break;case 3:m++;break;default:h++}e.inputEnabled=!1;var t=e.animations.add("hitted");e.play("hitted",100,!1),t.onComplete.add(this.fade,this,e)},this.fade=function(e){var t=x.add.tween(e).to({alpha:0},300,"Linear",!0);t.onComplete.add(this.killed,this,e)},this.killed=function(e){e.kill()}}var s,n=t(window).width(),o=t(window).height(),r=0,d=0,l=0,h=0,m=0,c=0,g="",f={num:1,selfPool:30,selfPic:"digger",rate:1.7,maxSpeed:700,minSpeed:600,max:95,point:1},p={num:2,selfPool:300,selfPic:"wheel",rate:1,maxSpeed:660,minSpeed:610,max:95,point:2},u={num:3,selfPool:30,selfPic:"gooddriver",rate:5.5,maxSpeed:750,minSpeed:720,max:95,point:3},v={num:4,selfPool:30,selfPic:"lglogo",rate:8.5,maxSpeed:800,minSpeed:730,max:95,point:3},T=40,w=n/375,x=new Phaser.Game(n,o,Phaser.AUTO,"");x.States={},x.States.boot=function(){this.preload=function(){"undefined"!=typeof GAME&&(this.load.baseURL=GAME+"/"),x.device.desktop||(this.scale.scaleMode=Phaser.ScaleManager.EXACT_FIT,this.scale.forcePortrait=!0,this.scale.refresh())},this.create=function(){x.stage.backgroundColor="#F6DE8C",x.state.start("preload")}},x.States.preload=function(){this.preload=function(){x.load.spritesheet("daojishi","assets/img/daojishi.png",200,200,3),x.load.image("bg","assets/img/bg.jpg"),x.load.spritesheet("digger","assets/img/digger.png",200,150,2),x.load.spritesheet("wheel","assets/img/wheel.png",200,150,2),x.load.spritesheet("gooddriver","assets/img/gooddriver.png",200,150,2),x.load.spritesheet("lglogo","assets/img/lglogo.png",157,150,2),x.load.image("gold","assets/img/gold.png"),x.load.audio("sound","./mp3/a1.mp3"),x.load.bitmapFont("number","assets/img/number.png","assets/img/number.xml")},this.create=function(){x.state.start("main")}},x.States.main=function(){this.create=function(){this.leftTime=T,x.physics.startSystem(Phaser.Physics.ARCADE);var e=x.add.sprite(0,0,"bg");e.width=x.width,e.height=x.height;var t=x.add.sprite(x.world.centerX-100,x.world.centerY-100,"daojishi"),a=t.animations.add("daojishi");t.play("daojishi",1,!1),a.onComplete.add(this.startGame,this,t),this.leftTimeText=x.add.bitmapText(0,0,"number","00:"+this.leftTime,26),this.leftTimeText.scale.setTo(i(1)),this.leftTimeText.fixedToCamera=!0,this.leftTimeText.cameraOffset.setTo(x.camera.width-i(80),x.camera.height-i(88)),this.chaiisanNum=x.add.bitmapText(0,0,"number",r.toString(),26),this.chaiisanNum.scale.setTo(i(1)),this.chaiisanNum.fixedToCamera=!0,this.chaiisanNum.cameraOffset.setTo(x.camera.width-i(80),x.camera.height-i(64))},this.update=function(){this.chaiisanNum.text=r},this.startGame=function(e){e.visible=!1,this.createQingLv(),x.time.events.repeat(Phaser.Timer.SECOND,this.leftTime,this.refreshTime,this)},this.createQingLv=function(){this.qinglv=new a(f),this.qinglv.init(),this.qinglv=new a(p),this.qinglv.init(),this.qinglv=new a(u),this.qinglv.init(),this.qinglv=new a(v),this.qinglv.init()},this.refreshTime=function(){this.leftTime--;var e=this.leftTime;if(this.leftTime<10&&(e="0"+this.leftTime),this.leftTimeText.text="00:"+e,0===this.leftTime){x.paused=!0,console.log("结束······");var i={amount:r,digger:l,gooddriver:m,id:"",lglogo:h,name:"",tel:window.localStorage.getItem("telphone"),time:"",wheel:d};t.ajax({type:"POST",url:"http://haosiji.sdlg.cn:8090/goodDriver/1.0/driverGameInfo",data:JSON.stringify(i),contentType:"application/json; charset=UTF-8",dataType:"json",success:function(e){"200"==e.code?(window.localStorage.setItem("sum",5*r),window.location.href="./result.html"):(alert("服务维护中···"),window.location.href="./index.html")},error:function(){alert("服务维护中···"),window.location.href="./index.html"}}),x.state.start("over")}}},x.States.over=function(){this.create=function(){console.log("结束的方法")}},x.state.add("boot",x.States.boot),x.state.add("preload",x.States.preload),x.state.add("main",x.States.main),x.state.add("over",x.States.over),x.state.start("boot")}(window,jQuery)}]);